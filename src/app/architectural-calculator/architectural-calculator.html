<div class="calculator-container">
  <div class="calculator-header">
    <h1 class="calculator-title">üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h1>
    <p class="calculator-subtitle">–†–∞—Å—á–µ—Ç –∫—Ä–∏–≤—ã—Ö –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</p>
  </div>

  <div class="calculator-content">
    <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∫—Ä–∏–≤–æ–π -->
    <div class="curve-selection">
      <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</h2>
      <div class="curve-tabs">
        <button 
          class="curve-tab" 
          [class.active]="selectedCurveType === 'parabola'"
          (click)="selectedCurveType = 'parabola'; onCurveTypeChange()">
          <span class="tab-icon">üåâ</span>
          <span class="tab-title">–ü–∞—Ä–∞–±–æ–ª–∞</span>
          <span class="tab-desc">–ê—Ä–∫–∏, –º–æ—Å—Ç—ã</span>
        </button>
        
        <button 
          class="curve-tab" 
          [class.active]="selectedCurveType === 'ellipse'"
          (click)="selectedCurveType = 'ellipse'; onCurveTypeChange()">
          <span class="tab-icon">üèõÔ∏è</span>
          <span class="tab-title">–≠–ª–ª–∏–ø—Å</span>
          <span class="tab-desc">–ö—É–ø–æ–ª–∞, —Å–≤–æ–¥—ã</span>
        </button>
        
        <button 
          class="curve-tab" 
          [class.active]="selectedCurveType === 'hyperbola'"
          (click)="selectedCurveType = 'hyperbola'; onCurveTypeChange()">
          <span class="tab-icon">üóº</span>
          <span class="tab-title">–ì–∏–ø–µ—Ä–±–æ–ª–∞</span>
          <span class="tab-desc">–ë–∞—à–Ω–∏, –æ–±–æ–ª–æ—á–∫–∏</span>
        </button>
      </div>
      
      <div class="curve-description">
        <p><strong>–¢–∏–ø–∏—á–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:</strong> {{ getCurveTypeDescription() }}</p>
      </div>
    </div>

    <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–≤–æ–¥–∞ -->
    <div class="parameters-section">
      <h2>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</h2>
      
      <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä–∞–±–æ–ª—ã -->
      <div *ngIf="selectedCurveType === 'parabola'" class="parameter-group">
        <div class="parameter-item">
          <label for="span">–ü—Ä–æ–ª—ë—Ç (L), –º:</label>
          <input 
            type="number" 
            id="span" 
            [(ngModel)]="parabolaParams.span" 
            min="1" 
            max="200"
            step="0.1">
          <span class="parameter-help">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –æ–ø–æ—Ä–∞–º–∏</span>
        </div>
        
        <div class="parameter-item">
          <label for="height">–í—ã—Å–æ—Ç–∞ (H), –º:</label>
          <input 
            type="number" 
            id="height" 
            [(ngModel)]="parabolaParams.height" 
            min="0.1" 
            max="50"
            step="0.1">
          <span class="parameter-help">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ</span>
        </div>
        
        <div class="parameter-item">
          <label for="thickness">–¢–æ–ª—â–∏–Ω–∞, –º:</label>
          <input 
            type="number" 
            id="thickness" 
            [(ngModel)]="parabolaParams.thickness" 
            min="0.01" 
            max="5"
            step="0.01">
          <span class="parameter-help">–¢–æ–ª—â–∏–Ω–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</span>
        </div>
      </div>

      <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–ª–ª–∏–ø—Å–∞ -->
      <div *ngIf="selectedCurveType === 'ellipse'" class="parameter-group">
        <div class="parameter-item">
          <label for="a">–ë–æ–ª—å—à–∞—è –ø–æ–ª—É–æ—Å—å (a), –º:</label>
          <input 
            type="number" 
            id="a" 
            [(ngModel)]="ellipseParams.a" 
            min="1" 
            max="100"
            step="0.1">
          <span class="parameter-help">–ü–æ–ª–æ–≤–∏–Ω–∞ –¥–ª–∏–Ω—ã –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏</span>
        </div>
        
        <div class="parameter-item">
          <label for="b">–ú–∞–ª–∞—è –ø–æ–ª—É–æ—Å—å (b), –º:</label>
          <input 
            type="number" 
            id="b" 
            [(ngModel)]="ellipseParams.b" 
            min="0.1" 
            max="50"
            step="0.1">
          <span class="parameter-help">–ü–æ–ª–æ–≤–∏–Ω–∞ –≤—ã—Å–æ—Ç—ã –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏</span>
        </div>
        
        <div class="parameter-item">
          <label for="thickness">–¢–æ–ª—â–∏–Ω–∞, –º:</label>
          <input 
            type="number" 
            id="thickness" 
            [(ngModel)]="ellipseParams.thickness" 
            min="0.01" 
            max="5"
            step="0.01">
          <span class="parameter-help">–¢–æ–ª—â–∏–Ω–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</span>
        </div>
      </div>

      <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–∏–ø–µ—Ä–±–æ–ª—ã -->
      <div *ngIf="selectedCurveType === 'hyperbola'" class="parameter-group">
        <div class="parameter-item">
          <label for="a">–ü–∞—Ä–∞–º–µ—Ç—Ä a, –º:</label>
          <input 
            type="number" 
            id="a" 
            [(ngModel)]="hyperbolaParams.a" 
            min="0.1" 
            max="50"
            step="0.1">
          <span class="parameter-help">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –¥–æ –≤–µ—Ä—à–∏–Ω—ã</span>
        </div>
        
        <div class="parameter-item">
          <label for="b">–ü–∞—Ä–∞–º–µ—Ç—Ä b, –º:</label>
          <input 
            type="number" 
            id="b" 
            [(ngModel)]="hyperbolaParams.b" 
            min="0.1" 
            max="50"
            step="0.1">
          <span class="parameter-help">–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É–≥–æ–ª —Ä–∞—Å–∫—Ä—ã—Ç–∏—è</span>
        </div>
        
        <div class="parameter-item">
          <label for="thickness">–¢–æ–ª—â–∏–Ω–∞, –º:</label>
          <input 
            type="number" 
            id="thickness" 
            [(ngModel)]="hyperbolaParams.thickness" 
            min="0.01" 
            max="5"
            step="0.01">
          <span class="parameter-help">–¢–æ–ª—â–∏–Ω–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</span>
        </div>
      </div>
    </div>

    <!-- –í—ã–±–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–∞ -->
    <div class="material-selection">
      <h2>–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª:</h2>
      <div class="material-grid">
        <div 
          *ngFor="let material of materials" 
          class="material-card"
          [class.selected]="selectedMaterial?.name === material.name"
          (click)="selectedMaterial = material">
          <div class="material-info">
            <h3>{{ material.name }}</h3>
            <p>–ü–ª–æ—Ç–Ω–æ—Å—Ç—å: {{ material.density }} –∫–≥/–º¬≥</p>
            <p>–°—Ç–æ–∏–º–æ—Å—Ç—å: {{ material.costPerUnit | number }} —Ä—É–±/–º¬≥</p>
          </div>
        </div>
      </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div class="action-buttons">
      <button class="btn-calculate" (click)="calculate()">
        <span class="btn-icon">üßÆ</span>
        –†–∞—Å—Å—á–∏—Ç–∞—Ç—å
      </button>
      
      <button class="btn-reset" (click)="resetCalculation()">
        <span class="btn-icon">üîÑ</span>
        –°–±—Ä–æ—Å–∏—Ç—å
      </button>


      <button class="btn-chart" (click)="toggle2DChart()" [class.active]="showChart">
        <span class="btn-icon">üìä</span>
        {{ showChart ? '–°–∫—Ä—ã—Ç—å –≥—Ä–∞—Ñ–∏–∫' : '–ü–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫' }}
      </button>
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <div *ngIf="showResults && calculationResult" class="results-section">
      <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞:</h2>
      
      <div class="results-grid">
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="result-card equation-card">
          <h3>üìê –£—Ä–∞–≤–Ω–µ–Ω–∏–µ</h3>
          <div class="equation">{{ calculationResult.equation }}</div>
        </div>

        <!-- –ò–∑–º–µ—Ä–µ–Ω–∏—è -->
        <div class="result-card measurements-card">
          <h3>üìè –ò–∑–º–µ—Ä–µ–Ω–∏—è</h3>
          <div class="measurement-item">
            <span class="label">–ü–ª–æ—â–∞–¥—å:</span>
            <span class="value">{{ calculationResult.measurements.area | number:'1.2-2' }} –º¬≤</span>
          </div>
          <div class="measurement-item">
            <span class="label">–î–ª–∏–Ω–∞ –¥—É–≥–∏:</span>
            <span class="value">{{ calculationResult.measurements.arcLength | number:'1.2-2' }} –º</span>
          </div>
          <div class="measurement-item">
            <span class="label">–û–±—ä–µ–º:</span>
            <span class="value">{{ calculationResult.measurements.volume | number:'1.2-2' }} –º¬≥</span>
          </div>
        </div>

        <!-- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã -->
        <div class="result-card materials-card">
          <h3>üèóÔ∏è –ú–∞—Ç–µ—Ä–∏–∞–ª—ã</h3>
          <div class="material-item">
            <span class="label">–ú–∞—Ç–µ—Ä–∏–∞–ª:</span>
            <span class="value">{{ calculationResult.materialEstimate.material.name }}</span>
          </div>
          <div class="material-item">
            <span class="label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</span>
            <span class="value">{{ calculationResult.materialEstimate.quantity | number:'1.2-2' }} –º¬≥</span>
          </div>
          <div class="material-item">
            <span class="label">–í–µ—Å:</span>
            <span class="value">{{ calculationResult.materialEstimate.weight | number:'1.0-0' }} –∫–≥</span>
          </div>
          <div class="material-item">
            <span class="label">–°—Ç–æ–∏–º–æ—Å—Ç—å:</span>
            <span class="value">{{ calculationResult.materialEstimate.totalCost | number:'1.0-0' }} —Ä—É–±</span>
          </div>
        </div>

        <!-- –°–≤–æ–π—Å—Ç–≤–∞ -->
        <div class="result-card properties-card">
          <h3>üîç –°–≤–æ–π—Å—Ç–≤–∞</h3>
          <div *ngIf="calculationResult.properties.foci" class="property-item">
            <span class="label">–§–æ–∫—É—Å—ã:</span>
            <div class="foci-list">
              <div *ngFor="let focus of calculationResult.properties.foci">
                ({{ focus.x | number:'1.2-2' }}, {{ focus.y | number:'1.2-2' }})
              </div>
            </div>
          </div>
          <div *ngIf="calculationResult.properties.eccentricity" class="property-item">
            <span class="label">–≠–∫—Å—Ü–µ–Ω—Ç—Ä–∏—Å–∏—Ç–µ—Ç:</span>
            <span class="value">{{ calculationResult.properties.eccentricity | number:'1.3-3' }}</span>
          </div>
          <div *ngIf="calculationResult.properties.asymptotes" class="property-item">
            <span class="label">–ê—Å–∏–º–ø—Ç–æ—Ç—ã:</span>
            <div class="asymptotes-list">
              <div *ngFor="let asymptote of calculationResult.properties.asymptotes">
                {{ asymptote }}
              </div>
            </div>
          </div>
        </div>

        <!-- –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ -->
        <div *ngIf="structuralAnalysis" class="result-card structural-card">
          <h3>üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑</h3>
          <div class="analysis-item">
            <span class="label">–ú–∞–∫—Å. –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ:</span>
            <span class="value">{{ structuralAnalysis.maxStress | number:'1.2-2' }} –ú–ü–∞</span>
          </div>
          <div class="analysis-item">
            <span class="label">–ö–æ—ç—Ñ. –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</span>
            <span class="value" [class.safe]="structuralAnalysis.safetyFactor >= 2" [class.warning]="structuralAnalysis.safetyFactor < 2">
              {{ structuralAnalysis.safetyFactor | number:'1.2-2' }}
            </span>
          </div>
          <div class="analysis-item">
            <span class="label">–ü—Ä–æ–≥–∏–±:</span>
            <span class="value">{{ structuralAnalysis.deflection | number:'1.2-2' }} –º–º</span>
          </div>
          <div class="analysis-item">
            <span class="label">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:</span>
            <span class="value">{{ structuralAnalysis.bucklingLoad | number:'1.0-0' }} –ù</span>
          </div>
          <div class="analysis-item">
            <span class="label">–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞:</span>
            <span class="value">{{ structuralAnalysis.naturalFrequency | number:'1.2-2' }} –ì—Ü</span>
          </div>
        </div>
      </div>

      <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
      <div *ngIf="recommendations && recommendations.length > 0" class="recommendations-section">
        <h3>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</h3>
        
        <div class="recommendations-list">
          <div *ngFor="let rec of recommendations" class="recommendation-card" 
               [style.border-left-color]="getSeverityColor(rec.severity)">
            <div class="recommendation-header">
              <span class="recommendation-icon">{{ getRecommendationIcon(rec.type) }}</span>
              <h4 class="recommendation-title">{{ rec.title }}</h4>
              <span class="recommendation-severity" [style.color]="getSeverityColor(rec.severity)">
                {{ rec.severity === 'critical' ? '–ö—Ä–∏—Ç–∏—á–Ω–æ' : 
                   rec.severity === 'high' ? '–í—ã—Å–æ–∫–∞—è' : 
                   rec.severity === 'medium' ? '–°—Ä–µ–¥–Ω—è—è' : '–ù–∏–∑–∫–∞—è' }}
              </span>
            </div>
            
            <div class="recommendation-body">
              <p class="recommendation-description">{{ rec.description }}</p>
              
              <div *ngIf="rec.currentValue !== undefined" class="recommendation-values">
                <div class="value-item">
                  <span class="label">–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</span>
                  <span class="value">{{ rec.currentValue | number:'1.2-2' }}</span>
                </div>
                <div *ngIf="rec.recommendedValue" class="value-item">
                  <span class="label">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ:</span>
                  <span class="value recommended">{{ rec.recommendedValue | number:'1.2-2' }}</span>
                </div>
              </div>
              
              <div *ngIf="rec.suggestion" class="recommendation-suggestion">
                <strong>üí¨ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> {{ rec.suggestion }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- –ì—Ä–∞—Ñ–∏–∫ -->
      <div *ngIf="calculationResult && showChart" class="graph-section">
        <h3>üìä –ì—Ä–∞—Ñ–∏–∫ –∫—Ä–∏–≤–æ–π</h3>
        <div class="graph-container">
          <canvas #chartCanvas></canvas>
        </div>
      </div>


      <!-- –≠–∫—Å–ø–æ—Ä—Ç -->
      <div class="export-section">
        <h3>üíæ –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
        <div class="export-buttons">
          <button class="btn-export" (click)="exportResults('json')">
            <span class="btn-icon">üìÑ</span>
            JSON
          </button>
          <button class="btn-export" (click)="exportResults('pdf')">
            <span class="btn-icon">üìã</span>
            PDF
          </button>
          <button class="btn-export" (click)="exportResults('excel')">
            <span class="btn-icon">üìä</span>
            Excel
          </button>
          <button class="btn-export" (click)="exportResults('word')">
            <span class="btn-icon">üìù</span>
            Word
          </button>
        </div>
      </div>
    </div>
  </div>
</div>